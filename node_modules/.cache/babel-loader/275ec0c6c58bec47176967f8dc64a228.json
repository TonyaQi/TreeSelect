{"ast":null,"code":"var _jsxFileName = \"/Users/qitong/\\u7EC3\\u4E60/TreeSelect/src/TreeSelect/index.js\";\nimport React from 'react';\nimport { Checkbox } from 'antd';\nimport { DownOutlined, RightOutlined } from '@ant-design/icons';\nimport clone from '../utils/index';\n\nclass TreeSelect extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.toggleExpand = (node, expand) => {\n      node.expand = expand;\n      this.forceUpdate();\n    };\n\n    this.makeChildren = (node, checked, value) => {\n      let que = [node];\n\n      while (que.length) {\n        let cur = que.shift();\n\n        if (cur.children && cur.children.length > 0) {\n          cur.children.forEach(item => {\n            if (item.checked !== checked) que.push(item);\n          });\n        }\n\n        cur.checked = checked;\n\n        if (checked) {\n          value.push({\n            title: cur.title,\n            key: cur.key\n          });\n        }\n      }\n    };\n\n    this.makeParent = (node, checked, value) => {\n      let current = node;\n\n      while (current.parent) {\n        let isHalf = current.parent.children.some(item => item.checked !== checked || item.indeterminate);\n        current.parent.checked = isHalf ? false : checked;\n        current.parent.indeterminate = isHalf;\n        current = current.parent;\n      }\n    };\n\n    this.setNodeStatus = (node, checked) => {\n      let value = [];\n      node.checked = checked;\n      this.makeChildren(node, checked, value);\n      console.log(value); // this.makeParent(node, checked, value);\n\n      this.forceUpdate();\n    };\n\n    this.generateTree = (data, lastNode) => {\n      if (!data || data.length < 1) return null;\n      return /*#__PURE__*/React.createElement(\"ul\", {\n        style: {\n          display: !lastNode || lastNode.expand ? 'block' : 'none'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 13\n        }\n      }, data.map(item => {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 29\n          }\n        }, Array.isArray(item.children) ? item.expand ? /*#__PURE__*/React.createElement(DownOutlined, {\n          onClick: () => this.toggleExpand(item, !item.expand),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91,\n            columnNumber: 33\n          }\n        }) : /*#__PURE__*/React.createElement(RightOutlined, {\n          onClick: () => this.toggleExpand(item, !item.expand),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 35\n          }\n        }) : null, /*#__PURE__*/React.createElement(Checkbox, {\n          checked: item.checked,\n          indeterminate: item.indeterminate,\n          onChange: () => this.setNodeStatus(item, !item.checked),\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 29\n          }\n        }, item.title), this.generateTree(item.children, item));\n      }));\n    };\n\n    this.data = clone(props.data);\n\n    const makeData = node => {\n      if (node && node.children) {\n        node.children.forEach(item => {\n          item.parent = node;\n          makeData(item);\n        });\n      }\n    };\n\n    this.data.forEach(item => {\n      makeData(item);\n    });\n    this.state = {\n      value: []\n    };\n  }\n\n  render() {\n    console.log(this.data);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }, this.generateTree(this.data));\n  }\n\n}\n\n;\nTreeSelect.propTypes = {\n  allowClear: Boolean,\n  placeholder: String,\n  searchPlaceholder: String,\n  showCheckedStrategy: String,\n  dropDownStyle: Object,\n  style: Object,\n  treeData: Array,\n  value: Array,\n  searchRange: Array,\n  onChange: Function,\n  filterTreeNode: Function\n};\nexport default TreeSelect;","map":{"version":3,"sources":["/Users/qitong/练习/TreeSelect/src/TreeSelect/index.js"],"names":["React","Checkbox","DownOutlined","RightOutlined","clone","TreeSelect","Component","constructor","props","toggleExpand","node","expand","forceUpdate","makeChildren","checked","value","que","length","cur","shift","children","forEach","item","push","title","key","makeParent","current","parent","isHalf","some","indeterminate","setNodeStatus","console","log","generateTree","data","lastNode","display","map","Array","isArray","makeData","state","render","propTypes","allowClear","Boolean","placeholder","String","searchPlaceholder","showCheckedStrategy","dropDownStyle","Object","style","treeData","searchRange","onChange","Function","filterTreeNode"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {Checkbox} from 'antd';\nimport {DownOutlined, RightOutlined} from '@ant-design/icons';\nimport clone from '../utils/index';\n\nclass TreeSelect extends React.Component{\n    \n    constructor(props) {\n        super(props);\n        this.data = clone(props.data)\n        const makeData = (node) => {\n            if(node && node.children) {\n                node.children.forEach(item => {\n                    item.parent = node;\n                    makeData(item);\n                })\n            }\n        }\n        this.data.forEach(item => {\n            makeData(item);\n        })\n\n        this.state = {\n            value: []\n        }\n    }\n\n\n    toggleExpand = (node, expand) => {\n        node.expand = expand;\n        this.forceUpdate();\n    }\n\n    makeChildren = (node, checked, value) => {\n        let que = [node];\n        while(que.length) {\n            let cur = que.shift();\n            if(cur.children && cur.children.length > 0 ) {\n                cur.children.forEach(item => {\n                    if(item.checked !== checked)\n                    que.push(item);\n                })\n            } \n            cur.checked = checked;\n            if(checked) {\n                value.push({\n                    title: cur.title,\n                    key: cur.key\n                })\n            }\n        }\n    }\n\n    makeParent = (node, checked, value) => {\n        let current = node;\n        while(current.parent) {\n            let isHalf = current.parent.children.some(item => item.checked !== checked || item.indeterminate)\n\n            current.parent.checked = isHalf ? false : checked;\n            current.parent.indeterminate = isHalf\n\n            current = current.parent\n        }\n    }\n\n\n    setNodeStatus = (node, checked) => {\n        let value = [];\n        node.checked = checked;\n        this.makeChildren(node, checked, value);\n        console.log(value);\n        // this.makeParent(node, checked, value);\n        this.forceUpdate();\n    }\n\n    generateTree = (data, lastNode) => {\n        if(!data || data.length < 1) return null;\n        return (\n            <ul \n                style={{\n                    display: (!lastNode || lastNode.expand) ? 'block' : 'none'\n                }}\n            >\n                {\n                    data.map(item => {\n                        return (\n                            <li>\n                            {\n                                Array.isArray(item.children) \n                                ? item.expand ? \n                                <DownOutlined onClick={() => this.toggleExpand(item, !item.expand)}/>\n                                : <RightOutlined onClick={() => this.toggleExpand(item, !item.expand)}/>\n                                : null\n                            }\n                            <Checkbox\n                                checked={item.checked}\n                                indeterminate={item.indeterminate}\n                                onChange={() => this.setNodeStatus(item, !item.checked)}\n                            >\n                                {item.title}\n                            </Checkbox>\n                            {\n                                this.generateTree(item.children, item)\n                            }\n                        </li>\n                        )\n                    })\n                }\n            </ul>\n        )\n    };\n\n    render(){\n        console.log(this.data);\n        return (\n            <div>\n                {\n                    this.generateTree(this.data)\n                }\n            </div>\n        )\n    }\n};\n\nTreeSelect.propTypes = {\n    allowClear: Boolean,\n    placeholder: String,\n    searchPlaceholder: String,\n    showCheckedStrategy: String,\n    dropDownStyle: Object,\n    style: Object,\n    treeData: Array,\n    value: Array,\n    searchRange: Array,\n    onChange: Function,\n    filterTreeNode: Function\n}\nexport default TreeSelect;"]},"metadata":{},"sourceType":"module"}